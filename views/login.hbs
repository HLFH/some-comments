<h1>You need to authenticate ({{user}})</h1>

<h2>Authenticate with:</h2>

<ul>
  <li><a href="/auth/facebook" target="_new">Facebook</a></li>
  <li><a href="/auth/googleOauth2" target="_new">Google Oauth 2.0</a></li>
</ul>

<script>
  console.log('Parent:', window.parent)

  window.addEventListener("message", function(event) {
    console.log('Got event.', event)
    //var origUrl   = parseUrl(event.origin)
    //var serverUrl = parseUrl(site.server)
    //
    //if (origUrl.hostname !== serverUrl.hostname) {
    //  console.log('Origin ' + origUrl.hostname + ' != ' + serverUrl.hostname + '.  Ignoring.')
    //  return
    //}

    if (!event.data.authenticated) {return deferred.reject('Not authenticated')}

    // Forward to parent.
    window.parent.postMessage({authenticated: true}, '*')
  }, false);
</script>
